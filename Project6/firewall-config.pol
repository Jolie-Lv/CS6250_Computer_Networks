# CS 6250 Spring 2020 - Firewall Policy
# Rule number, srcmac, dstmac, srcip, dstip, srcport, dstport, protocol, ipprotocol
# Rule number is incremented each time - mostly for debug purposes
# - for a rule element indicates that you don't need to match it.
# Comments are on their own line

# 1. Block PPTP on server2 for all hosts accessing TCP destination 
# port 1723 and the GRE IP Protocol
1, -, -, -, 10.0.0.6, -, 1723, T, -
2, -, -, -, 10.0.0.6, -, -, O, 47
3, -, 00:00:00:00:00:06, -, -, -, 1723, T, -
4, -, 00:00:00:00:00:06, -, -, -, -, O, 47

# 2. Negate all hosts from accessing a SSH server on the east hosts (e1-e3).
5, -, -, -, 10.0.0.2, -, 22, T, -
6, -, -, -, 10.0.0.3, -, 22, T, -
7, -, -, -, 10.0.0.4, -, 22, T, -
8, -, 00:00:00:00:00:02, -, -, -, 22, T, -
9, -, 00:00:00:00:00:03, -, -, -, 22, T, -
10, -, 00:00:00:00:00:04, -, -, -, 22, T, -

# 3. Protect the DNS and NTP Services on both server1 and server2 
# from being accessed by all hosts.
11, -, -, -, 10.0.0.5, -, 53, U, -
12, -, -, -, 10.0.0.5, -, 123, U, -
13, -, -, -, 10.0.0.6, -, 53, U, -
14, -, -, -, 10.0.0.6, -, 123, U, -
15, -, 00:00:00:00:00:05, -, -, -, 53, U, -
16, -, 00:00:00:00:00:05, -, -, -, 123, U, -
17, -, 00:00:00:00:00:06, -, -, -, 53, U, -
18, -, 00:00:00:00:00:06, -, -, -, 123, U, -

# 4. Disallow hosts w1 and w2 from pinging client1.
19, -, -, 10.0.0.8, 10.0.0.1, -, -, O, 1
20, -, -, 10.0.0.9, 10.0.0.1, -, -, O, 1
21, 00:00:00:00:00:08, -, -, 10.0.0.1, -, -, O, 1
22, 00:00:00:00:00:09, -, -, 10.0.0.1, -, -, O, 1
23, -, 00:00:00:00:00:01, 10.0.0.8, -, -, -, O, 1
24, -, 00:00:00:00:00:01, 10.0.0.9, -, -, -, O, 1
25, 00:00:00:00:00:08, 00:00:00:00:00:01, -, -, -, -, O, 1
26, 00:00:00:00:00:09, 00:00:00:00:00:01, -, -, -, -, O, 1

# 5. Disallow host e1 from accessing all traffic destined to TCP ports
# 9950-9952 on host e3.
27, -, -, 10.0.0.2, 10.0.0.4, 9950, -, T, -
28, -, -, 10.0.0.2, 10.0.0.4, 9951, -, T, -
29, -, -, 10.0.0.2, 10.0.0.4, 9952, -, T, -
30, 00:00:00:00:00:02, -, -, 10.0.0.4, 9950, -, T, -
31, 00:00:00:00:00:02, -, -, 10.0.0.4, 9951, -, T, -
32, 00:00:00:00:00:02, -, -, 10.0.0.4, 9952, -, T, -
33, -, 00:00:00:00:00:04, 10.0.0.2, -, 9950, -, T, -
34, -, 00:00:00:00:00:04, 10.0.0.2, -, 9951, -, T, -
35, -, 00:00:00:00:00:04, 10.0.0.2, -, 9952, -, T, -
36, 00:00:00:00:00:02, 00:00:00:00:00:04, -, -, 9950, -, T, -
37, 00:00:00:00:00:02, 00:00:00:00:00:04, -, -, 9951, -, T, -
38, 00:00:00:00:00:02, 00:00:00:00:00:04, -, -, 9952, -, T, -

# 6. Restrict host client1 from accessing any of the east hosts (e1-e3)
# on both TCP and UDP protocols.
39, -, -, 10.0.0.1, 10.0.0.2, -, -, B, -
40, -, -, 10.0.0.1, 10.0.0.3, -, -, B, -
41, -, -, 10.0.0.1, 10.0.0.4, -, -, B, -
42, 00:00:00:00:00:01, -, -, 10.0.0.2, -, -, B, -
43, 00:00:00:00:00:01, -, -, 10.0.0.3, -, -, B, -
44, 00:00:00:00:00:01, -, -, 10.0.0.4, -, -, B, -
45, -, 00:00:00:00:00:02, 10.0.0.1, -, -, -, B, -
46, -, 00:00:00:00:00:03, 10.0.0.1, -, -, -, B, -
47, -, 00:00:00:00:00:04, 10.0.0.1, -, -, -, B, -
48, 00:00:00:00:00:01, 00:00:00:00:00:02, -, -, -, -, B, -
49, 00:00:00:00:00:01, 00:00:00:00:00:03, -, -, -, -, B, -
50, 00:00:00:00:00:01, 00:00:00:00:00:04, -, -, -, -, B, -

# 7. Prohibit all hosts from accessing a L2TP/IPSEC server running on server3.
51, -, -, -, 10.0.0.7, -, 1701, U, -
52, -, -, -, 10.0.0.7, -, 500, U, -
53, -, 00:00:00:00:00:07, -, -, -, 1701, U, -
54, -, 00:00:00:00:00:07, -, -, -, 500, U, -